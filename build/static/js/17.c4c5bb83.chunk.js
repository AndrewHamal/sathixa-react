(this["webpackJsonpsathixa-react"]=this["webpackJsonpsathixa-react"]||[]).push([[17],{553:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=n(554),o=(a=r)&&a.__esModule?a:{default:a};function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}var h=function(e){function t(){return s(this,t),u(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),i(t,[{key:"update",value:function(e){this.x=e.x,this.y=e.y}},{key:"moveByAngle",value:function(e,t){var n=e+Math.PI/2;this.x=this.x+Math.sin(n)*t,this.y=this.y-Math.cos(n)*t}},{key:"equalsTo",value:function(e){return this.x===e.x&&this.y===e.y}},{key:"getDifferenceTo",value:function(e){return new o.default(this.x-e.x,this.y-e.y)}},{key:"getDistanceTo",value:function(e){var t=this.getDifferenceTo(e);return Math.sqrt(Math.pow(t.x,2)+Math.pow(t.y,2))}},{key:"getAngleTo",value:function(e){var t=this.getDifferenceTo(e);return Math.atan2(t.y,t.x)}},{key:"toObject",value:function(){return{x:this.x,y:this.y}}}]),t}(o.default);t.default=h},554:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.x=t,this.y=n}},555:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();var i=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.x=t,this.y=n}return a(e,[{key:"update",value:function(e){this.x=e.x,this.y=e.y}},{key:"getDifferenceTo",value:function(t){return new e(this.x-t.x,this.y-t.y)}},{key:"getDistanceTo",value:function(e){var t=this.getDifferenceTo(e);return Math.sqrt(Math.pow(t.x,2)+Math.pow(t.y,2))}}]),e}();t.default=i},663:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LazyPoint=t.Point=t.LazyBrush=void 0;var a=o(n(664)),i=o(n(554)),r=o(n(553));function o(e){return e&&e.__esModule?e:{default:e}}t.LazyBrush=a.default,t.Point=i.default,t.LazyPoint=r.default},664:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=n(553),o=(a=r)&&a.__esModule?a:{default:a};function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var u=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.radius,a=void 0===n?30:n,i=t.enabled,r=void 0===i||i,u=t.initialPoint,h=void 0===u?{x:0,y:0}:u;s(this,e),this.radius=a,this._isEnabled=r,this.pointer=new o.default(h.x,h.y),this.brush=new o.default(h.x,h.y),this.angle=0,this.distance=0,this._hasMoved=!1}return i(e,[{key:"enable",value:function(){this._isEnabled=!0}},{key:"disable",value:function(){this._isEnabled=!1}},{key:"isEnabled",value:function(){return this._isEnabled}},{key:"setRadius",value:function(e){this.radius=e}},{key:"getRadius",value:function(){return this.radius}},{key:"getBrushCoordinates",value:function(){return this.brush.toObject()}},{key:"getPointerCoordinates",value:function(){return this.pointer.toObject()}},{key:"getBrush",value:function(){return this.brush}},{key:"getPointer",value:function(){return this.pointer}},{key:"getAngle",value:function(){return this.angle}},{key:"getDistance",value:function(){return this.distance}},{key:"brushHasMoved",value:function(){return this._hasMoved}},{key:"update",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.both,a=void 0!==n&&n;return this._hasMoved=!1,!(this.pointer.equalsTo(e)&&!a)&&(this.pointer.update(e),a?(this._hasMoved=!0,this.brush.update(e),!0):(this._isEnabled?(this.distance=this.pointer.getDistanceTo(this.brush),this.angle=this.pointer.getAngleTo(this.brush),this.distance>this.radius&&(this.brush.moveByAngle(this.angle,this.distance-this.radius),this._hasMoved=!0)):(this.distance=0,this.angle=0,this.brush.update(e),this._hasMoved=!0),!0))}}]),e}();t.default=u},665:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Point=t.Catenary=void 0;var a=r(n(666)),i=r(n(555));function r(e){return e&&e.__esModule?e:{default:e}}t.Catenary=a.default,t.Point=i.default},666:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=n(555),o=(a=r)&&a.__esModule?a:{default:a};function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var u=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.segments,a=void 0===n?50:n,i=t.iterationLimit,r=void 0===i?100:i;s(this,e),this.p1=new o.default,this.p2=new o.default,this.segments=a,this.iterationLimit=r}return i(e,[{key:"drawToCanvas",value:function(e,t,n,a){this.p1.update(t),this.p2.update(n);var i=this.p1.x>this.p2.x,r=i?this.p2:this.p1,o=i?this.p1:this.p2,s=[],u=!0;if(r.getDistanceTo(o)<a)if(o.x-r.x>.01){var h=o.x-r.x,c=o.y-r.y,l=-this.getCatenaryParameter(h,c,a,this.iterationLimit),d=.5*(l*Math.log((a+c)/(a-c))-h),f=l*Math.cosh(d/l),p=r.x-d,v=r.y-f;s=this.getCurve(l,r,o,p,v,this.segments),u=!1}else{var y=.5*(r.x+o.x),g=.5*(r.y+o.y+a);s=[[r.x,r.y],[y,g],[o.x,o.y]]}else s=[[r.x,r.y],[o.x,o.y]];return u?this.drawLine(s,e):this.drawCurve(s,e),s}},{key:"getCatenaryParameter",value:function(e,t,n,a){for(var i=Math.sqrt(n*n-t*t)/e,r=Math.acosh(i)+1,o=-1,s=0;Math.abs(r-o)>1e-6&&s<a;)o=r,r-=(Math.sinh(r)-i*r)/(Math.cosh(r)-i),s++;return e/(2*r)}},{key:"getCurve",value:function(e,t,n,a,i,r){for(var o=[t.x,e*Math.cosh((t.x-a)/e)+i],s=n.x-t.x,u=r-1,h=0;h<u;h++){var c=t.x+s*(h+.5)/u,l=e*Math.cosh((c-a)/e)+i;o.push(c,l)}return o.push(n.x,e*Math.cosh((n.x-a)/e)+i),o}},{key:"drawLine",value:function(e,t){t.moveTo(e[0][0],e[0][1]),t.lineTo(e[1][0],e[1][1])}},{key:"drawCurve",value:function(e,t){var n=.5*e.length-1,a=e[2],i=e[3],r=[];t.moveTo(e[0],e[1]);for(var o=2;o<n;o++){var s=e[2*o],u=e[2*o+1],h=.5*(s+a),c=.5*(u+i);r.push([a,i,h,c]),t.quadraticCurveTo(a,i,h,c),a=s,i=u}return n=e.length,t.quadraticCurveTo(e[n-4],e[n-3],e[n-2],e[n-1]),r}}]),e}();t.default=u},669:function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var a=n(0),i=n.n(a),r=n(9),o=n.n(r),s=n(663),u=n(665),h=n(152);var c,l,d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e};function f(e,t){return{x:e.x+(t.x-e.x)/2,y:e.y+(t.y-e.y)/2}}var p={display:"block",position:"absolute"},v=[{name:"interface",zIndex:15},{name:"drawing",zIndex:11},{name:"temp",zIndex:12},{name:"grid",zIndex:10}],y=o.a.oneOfType([o.a.number,o.a.string]),g=(l=c=function(e){function t(n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,e.call(this,n));return a.componentWillUnmount=function(){a.canvasObserver.unobserve(a.canvasContainer)},a.drawImage=function(){a.props.imgSrc&&(a.image=new Image,a.image.crossOrigin="anonymous",a.image.onload=function(){return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.ctx,n=e.img,a=e.x,i=e.y,r=e.w,o=e.h,s=e.offsetX,u=e.offsetY;"number"!==typeof a&&(a=0),"number"!==typeof i&&(i=0),"number"!==typeof r&&(r=t.canvas.width),"number"!==typeof o&&(o=t.canvas.height),"number"!==typeof s&&(s=.5),"number"!==typeof u&&(u=.5),s<0&&(s=0),u<0&&(u=0),s>1&&(s=1),u>1&&(u=1);var h,c,l,d,f=n.width,p=n.height,v=Math.min(r/f,o/p),y=f*v,g=p*v,b=1;y<r&&(b=r/y),Math.abs(b-1)<1e-14&&g<o&&(b=o/g),(h=(f-(l=f/((y*=b)/r)))*s)<0&&(h=0),(c=(p-(d=p/((g*=b)/o)))*u)<0&&(c=0),l>f&&(l=f),d>p&&(d=p),t.drawImage(n,h,c,l,d,a,i,r,o)}({ctx:a.ctx.grid,img:a.image})},a.image.src=a.props.imgSrc)},a.undo=function(){var e=a.lines.slice(0,-1);a.clear(),a.simulateDrawingLines({lines:e,immediate:!0}),a.triggerOnChange()},a.getSaveData=function(){return JSON.stringify({lines:a.lines,width:a.props.canvasWidth,height:a.props.canvasHeight})},a.loadSaveData=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a.props.immediateLoading;if("string"!==typeof e)throw new Error("saveData needs to be of type string!");var n=JSON.parse(e),i=n.lines,r=n.width,o=n.height;if(!i||"function"!==typeof i.push)throw new Error("saveData.lines needs to be an array!");if(a.clear(),r===a.props.canvasWidth&&o===a.props.canvasHeight)a.simulateDrawingLines({lines:i,immediate:t});else{var s=a.props.canvasWidth/r,u=a.props.canvasHeight/o,h=(s+u)/2;a.simulateDrawingLines({lines:i.map((function(e){return d({},e,{points:e.points.map((function(e){return{x:e.x*s,y:e.y*u}})),brushRadius:e.brushRadius*h})})),immediate:t})}},a.simulateDrawingLines=function(e){var t=e.lines,n=e.immediate,i=0,r=n?0:a.props.loadTimeOffset;t.forEach((function(e){var t=e.points,o=e.brushColor,s=e.brushRadius;if(n)return a.drawPoints({points:t,brushColor:o,brushRadius:s}),a.points=t,void a.saveLine({brushColor:o,brushRadius:s});for(var u=function(e){i+=r,window.setTimeout((function(){a.drawPoints({points:t.slice(0,e+1),brushColor:o,brushRadius:s})}),i)},h=1;h<t.length;h++)u(h);i+=r,window.setTimeout((function(){a.points=t,a.saveLine({brushColor:o,brushRadius:s})}),i)}))},a.handleDrawStart=function(e){e.preventDefault(),a.isPressing=!0;var t=a.getPointerPos(e),n=t.x,i=t.y;e.touches&&e.touches.length>0&&a.lazy.update({x:n,y:i},{both:!0}),a.handlePointerMove(n,i)},a.handleDrawMove=function(e){e.preventDefault();var t=a.getPointerPos(e),n=t.x,i=t.y;a.handlePointerMove(n,i)},a.handleDrawEnd=function(e){e.preventDefault(),a.handleDrawMove(e),a.isDrawing=!1,a.isPressing=!1,a.saveLine()},a.handleCanvasResize=function(e,t){var n=a.getSaveData(),i=e,r=Array.isArray(i),o=0;for(i=r?i:i[Symbol.iterator]();;){var s;if(r){if(o>=i.length)break;s=i[o++]}else{if((o=i.next()).done)break;s=o.value}var u=s.contentRect,h=u.width,c=u.height;a.setCanvasSize(a.canvas.interface,h,c),a.setCanvasSize(a.canvas.drawing,h,c),a.setCanvasSize(a.canvas.temp,h,c),a.setCanvasSize(a.canvas.grid,h,c),a.drawGrid(a.ctx.grid),a.drawImage(),a.loop({once:!0})}a.loadSaveData(n,!0)},a.setCanvasSize=function(e,t,n){e.width=t,e.height=n,e.style.width=t,e.style.height=n},a.getPointerPos=function(e){var t=a.canvas.interface.getBoundingClientRect(),n=e.clientX,i=e.clientY;return e.changedTouches&&e.changedTouches.length>0&&(n=e.changedTouches[0].clientX,i=e.changedTouches[0].clientY),{x:n-t.left,y:i-t.top}},a.handlePointerMove=function(e,t){if(!a.props.disabled){a.lazy.update({x:e,y:t});var n=!a.lazy.isEnabled();(a.isPressing&&!a.isDrawing||n&&a.isPressing)&&(a.isDrawing=!0,a.points.push(a.lazy.brush.toObject())),a.isDrawing&&(a.points.push(a.lazy.brush.toObject()),a.drawPoints({points:a.points,brushColor:a.props.brushColor,brushRadius:a.props.brushRadius})),a.mouseHasMoved=!0}},a.drawPoints=function(e){var t=e.points,n=e.brushColor,i=e.brushRadius;a.ctx.temp.lineJoin="round",a.ctx.temp.lineCap="round",a.ctx.temp.strokeStyle=n,a.ctx.temp.clearRect(0,0,a.ctx.temp.canvas.width,a.ctx.temp.canvas.height),a.ctx.temp.lineWidth=2*i;var r=t[0],o=t[1];a.ctx.temp.moveTo(o.x,o.y),a.ctx.temp.beginPath();for(var s=1,u=t.length;s<u;s++){var h=f(r,o);a.ctx.temp.quadraticCurveTo(r.x,r.y,h.x,h.y),r=t[s],o=t[s+1]}a.ctx.temp.lineTo(r.x,r.y),a.ctx.temp.stroke()},a.saveLine=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.brushColor,n=e.brushRadius;if(!(a.points.length<2)){a.lines.push({points:[].concat(a.points),brushColor:t||a.props.brushColor,brushRadius:n||a.props.brushRadius}),a.points.length=0;var i=a.canvas.temp.width,r=a.canvas.temp.height;a.ctx.drawing.drawImage(a.canvas.temp,0,0,i,r),a.ctx.temp.clearRect(0,0,i,r),a.triggerOnChange()}},a.triggerOnChange=function(){a.props.onChange&&a.props.onChange(a)},a.clear=function(){a.lines=[],a.valuesChanged=!0,a.ctx.drawing.clearRect(0,0,a.canvas.drawing.width,a.canvas.drawing.height),a.ctx.temp.clearRect(0,0,a.canvas.temp.width,a.canvas.temp.height)},a.loop=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.once,n=void 0!==t&&t;if(a.mouseHasMoved||a.valuesChanged){var i=a.lazy.getPointerCoordinates(),r=a.lazy.getBrushCoordinates();a.drawInterface(a.ctx.interface,i,r),a.mouseHasMoved=!1,a.valuesChanged=!1}n||window.requestAnimationFrame((function(){a.loop()}))},a.drawGrid=function(e){if(!a.props.hideGrid){e.clearRect(0,0,e.canvas.width,e.canvas.height),e.beginPath(),e.setLineDash([5,1]),e.setLineDash([]),e.strokeStyle=a.props.gridColor,e.lineWidth=.5;for(var t=0;t<e.canvas.width;)t+=25,e.moveTo(t,0),e.lineTo(t,e.canvas.height);e.stroke();for(var n=0;n<e.canvas.height;)n+=25,e.moveTo(0,n),e.lineTo(e.canvas.width,n);e.stroke()}},a.drawInterface=function(e,t,n){a.props.hideInterface||(e.clearRect(0,0,e.canvas.width,e.canvas.height),e.beginPath(),e.fillStyle=a.props.brushColor,e.arc(n.x,n.y,a.props.brushRadius,0,2*Math.PI,!0),e.fill(),e.beginPath(),e.fillStyle=a.props.catenaryColor,e.arc(t.x,t.y,4,0,2*Math.PI,!0),e.fill(),a.lazy.isEnabled()&&(e.beginPath(),e.lineWidth=2,e.lineCap="round",e.setLineDash([2,4]),e.strokeStyle=a.props.catenaryColor,a.catenary.drawToCanvas(a.ctx.interface,n,t,a.chainLength),e.stroke()),e.beginPath(),e.fillStyle=a.props.catenaryColor,e.arc(n.x,n.y,2,0,2*Math.PI,!0),e.fill())},a.canvas={},a.ctx={},a.catenary=new u.Catenary,a.points=[],a.lines=[],a.mouseHasMoved=!0,a.valuesChanged=!0,a.isDrawing=!1,a.isPressing=!1,a}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.componentDidMount=function(){var e=this;this.lazy=new s.LazyBrush({radius:this.props.lazyRadius*window.devicePixelRatio,enabled:!0,initialPoint:{x:window.innerWidth/2,y:window.innerHeight/2}}),this.chainLength=this.props.lazyRadius*window.devicePixelRatio,this.canvasObserver=new h.a((function(t,n){return e.handleCanvasResize(t,n)})),this.canvasObserver.observe(this.canvasContainer),this.drawImage(),this.loop(),window.setTimeout((function(){var t=window.innerWidth/2,n=window.innerHeight/2;e.lazy.update({x:t-e.chainLength/4,y:n},{both:!0}),e.lazy.update({x:t+e.chainLength/4,y:n},{both:!1}),e.mouseHasMoved=!0,e.valuesChanged=!0,e.clear(),e.props.saveData&&e.loadSaveData(e.props.saveData)}),100)},t.prototype.componentDidUpdate=function(e){e.lazyRadius!==this.props.lazyRadius&&(this.chainLength=this.props.lazyRadius*window.devicePixelRatio,this.lazy.setRadius(this.props.lazyRadius*window.devicePixelRatio)),e.saveData!==this.props.saveData&&this.loadSaveData(this.props.saveData),JSON.stringify(e)!==JSON.stringify(this.props)&&(this.valuesChanged=!0)},t.prototype.render=function(){var e=this;return i.a.createElement("div",{className:this.props.className,style:d({display:"block",background:this.props.backgroundColor,touchAction:"none",width:this.props.canvasWidth,height:this.props.canvasHeight},this.props.style),ref:function(t){t&&(e.canvasContainer=t)}},v.map((function(t){var n=t.name,a=t.zIndex,r="interface"===n;return i.a.createElement("canvas",{key:n,ref:function(t){t&&(e.canvas[n]=t,e.ctx[n]=t.getContext("2d"))},style:d({},p,{zIndex:a}),onMouseDown:r?e.handleDrawStart:void 0,onMouseMove:r?e.handleDrawMove:void 0,onMouseUp:r?e.handleDrawEnd:void 0,onMouseOut:r?e.handleDrawEnd:void 0,onTouchStart:r?e.handleDrawStart:void 0,onTouchMove:r?e.handleDrawMove:void 0,onTouchEnd:r?e.handleDrawEnd:void 0,onTouchCancel:r?e.handleDrawEnd:void 0})})))},t}(a.PureComponent),c.propTypes={onChange:o.a.func,loadTimeOffset:o.a.number,lazyRadius:o.a.number,brushRadius:o.a.number,brushColor:o.a.string,catenaryColor:o.a.string,gridColor:o.a.string,backgroundColor:o.a.string,hideGrid:o.a.bool,canvasWidth:y,canvasHeight:y,disabled:o.a.bool,imgSrc:o.a.string,saveData:o.a.string,immediateLoading:o.a.bool,hideInterface:o.a.bool},c.defaultProps={onChange:null,loadTimeOffset:5,lazyRadius:12,brushRadius:10,brushColor:"#444",catenaryColor:"#0a0302",gridColor:"rgba(150,150,150,0.17)",backgroundColor:"#FFF",hideGrid:!1,canvasWidth:400,canvasHeight:400,disabled:!1,imgSrc:"",saveData:"",immediateLoading:!1,hideInterface:!1},l)}}]);
//# sourceMappingURL=17.c4c5bb83.chunk.js.map