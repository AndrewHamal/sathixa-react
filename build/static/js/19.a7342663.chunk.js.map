{"version":3,"sources":["components/rider/DeliverSignModal.js","components/rider/CancelReasonModal.js","components/maps/MyMap.js","pages/rider/Dashboard.js"],"names":["ModelSign","props","isModalVisible","signpad","completeDelivery","handleCancel","clearSign","loading","alert","modelMobile","visible","footer","onCancel","style","top","className","ref","penColor","canvasProps","block","type","onClick","disabled","text","onPress","console","log","CancelReasonsModal","cancelReasonModal","setCancelReasonModal","cancelSubmit","radio","handleRadio","cancelReason","TextArea","Input","onSubmit","Group","name","defaultValue","onChange","direction","map","res","key","value","id","title","required","rows","placeholder","htmlType","L","Default","prototype","_getIconUrl","mergeOptions","iconRetinaUrl","iconUrl","iconSize","Point","shadowUrl","iconRider","MapComp","markerLayer","packageAlert","setSummary","refetch","isIOS","navigator","userAgent","match","leafletMap","useRef","dispatch","useDispatch","history","useHistory","useState","setSearch","location","setLocation","setHeading","allLocations","useSelector","allVendorLocation","userSelector","getUser","lat","long","iconAccurate","html","iconAnchor","useEffect","current","isMounted","leafletElement","length","getAllVendorLocation","then","storeVendorLocation","data","startCompass","DeviceOrientationEvent","requestPermission","response","window","addEventListener","handler","catch","e","compass","webkitCompassHeading","Math","abs","alpha","path","transform","fromLat","vendor","fromLong","toLat","toLong","control","waypoints","useZoomParameter","pointMarkerStyle","display","summaryTemplate","info","summary","distance","time","addTo","deactive","listen","geoWatch","geolocation","clearWatch","marker","watchMyLocateMe","options","enableHighAccuracy","watchPosition","coords","latitude","longitude","heading","setView","clearLayers","setLatLng","Nominatim","lon","addressdetails","zoom","result","document","querySelector","display_name","icon","draggable","storeRiderLocation","error","err","warn","code","message","bindPopup","openPopup","markerSet","on","target","_latlng","address","suburb","town","city","region","county","country","center","minZoom","maxZoom","keyboard","doubleClickZoom","scrollWheelZoom","TileLayer","url","attribution","Marker","position","Tooltip","sticky","offset","opacity","first_name","last_name","latLng","inputPlaceholder","showMarker","closeResultsOnClick","openSearchOnLoad","providerOptions","searchBounds","AimOutlined","fontSize","RiderAccept","mainHistory","setIsModalVisible","statusPackage","setStatusPackage","setLoading","setRefetch","loadingCanc","setLoadingCanc","setCancelReason","setRadio","dialogAccept","showButtonRef","packageAlertData","Modal","fetchRecentPackage","onGoingPackage","storePackageAlert","package","Toast","fail","setTimeout","riderAcceptPackage","formData","FormData","append","updateRiderStatus","success","acceptPackage","getCancelReason","Completionist","src","width","MyMap","process_step","visibility","bottom","href","phone","PhoneOutlined","height","date","Date","now","renderer","seconds","category","no_of_package","whole_address","clear","getTrimmedCanvas","img","toDataURL","dataURLtoFile","receiver_name","savePackageSignature","preventDefault","saveCancelReason","Object","entries","errors"],"mappings":"uHAAA,8DA0CeA,IAnCG,SAACC,GAEf,IAAKC,EAA+ED,EAA/EC,eAAgBC,EAA+DF,EAA/DE,QAASC,EAAsDH,EAAtDG,iBAAkBC,EAAoCJ,EAApCI,aAAcC,EAAsBL,EAAtBK,UAAWC,EAAWN,EAAXM,QAEnEC,EAAQC,IAAYD,MAE1B,OACI,eAAC,IAAD,CACIE,QAASR,EACTS,OAAQ,KACRC,SAAUP,EACVQ,MAAO,CAAEC,IAAK,IAJlB,UAMI,mBAAGC,UAAU,8BAAb,gCAEQ,cAAC,IAAD,CAAiBC,IAAKb,EAASc,SAAS,QACxCC,YAAa,CAACH,UAAW,mCACzB,cAAC,IAAD,CAAQI,OAAK,EAACC,KAAK,GAAGC,QAASf,EAAWS,UAAU,OAApD,6BAGR,cAAC,IAAD,CAAQO,SAAUf,EAASY,OAAK,EAACC,KAAK,UAC9BC,QAAS,kBACLb,EAAM,oBAAqB,kBAAmB,CAC1C,CAAEe,KAAM,SAAUC,QAAS,kBAAMC,QAAQC,IAAI,YAC7C,CAAEH,KAAM,KAAMC,QAAS,kBAAMpB,SAGrCW,UAAU,OAPlB,SASSR,EAAU,cAAC,IAAD,IAAsB,2B,iCCnCrD,+DAmDeoB,IA9CY,SAAC1B,GACxB,IAAM2B,EAAqG3B,EAArG2B,kBAAmBC,EAAkF5B,EAAlF4B,qBAAsBC,EAA4D7B,EAA5D6B,aAAcC,EAA8C9B,EAA9C8B,MAAOC,EAAuC/B,EAAvC+B,YAAcC,EAAyBhC,EAAzBgC,aAAc1B,EAAWN,EAAXM,QACxF2B,EAAaC,IAAbD,SAER,OACF,eAAC,IAAD,CACMxB,QAASkB,EACTjB,OAAQ,KACRC,SAAU,kBAAMiB,GAAqB,IACrChB,MAAO,CAAEC,IAAK,IAJpB,UAMU,mBAAGC,UAAU,mBAAb,6CACA,qBAAKA,UAAU,OAAf,SACA,uBAAMqB,SAAUN,EAAhB,UACI,cAAC,IAAMO,MAAP,CAAaC,KAAK,oBAAoBC,aAAcR,EAAOS,SAAUR,EAArE,SACI,eAAC,IAAD,CAAOS,UAAU,WAAjB,iBAEQR,QAFR,IAEQA,OAFR,EAEQA,EAAcS,KAAI,SAACC,EAAKC,GAAN,OACd,eAAC,IAAD,CAAOC,MAAOF,EAAIG,GAAlB,UAAmCH,EAAII,MAAvC,MAA4BH,MAGpC,cAAC,IAAD,CAAOC,MAAO,EAAd,wBAKM,IAAVd,EACA,cAACG,EAAD,CACAc,UAAU,EACVjC,UAAU,OACVkC,KAAM,EACNX,KAAM,uBACNY,YAAY,sBACP,KAGT,cAAC,IAAD,CAAQ/B,OAAK,EAACC,KAAK,UAAUL,UAAU,YAAYoC,SAAS,SAA5D,SACI5C,EAAU,cAAC,IAAD,IAAsB,qB,wTC1B7C6C,OAAOC,QAAQC,UAAUC,YAEhCH,OAAOC,QAAQG,aAAa,CACxBC,cAAe,mBACfC,QAAS,mBACTC,SAAU,IAAIC,QAAM,GAAI,IACxBC,UAAY,KAGhB,IAAMC,EAAYV,OAAO,CACrBK,cAAe,kBACfC,QAAS,kBACTC,SAAU,IAAIC,QAAM,GAAI,IACxBC,UAAY,KA4ZDE,GAzZIX,OAAO,CACtBK,cAAe,mBACfC,QAAS,mBACTC,SAAU,IAAIC,QAAM,GAAI,IACxBC,UAAY,KAIA,SAAC5D,GACb,IAgBI+D,EAhBEC,EAAsChE,EAAtCgE,aAAcC,EAAwBjE,EAAxBiE,WAAYC,EAAYlE,EAAZkE,QAC1BC,EACNC,UAAUC,UAAUC,MAAM,uBAC1BF,UAAUC,UAAUC,MAAM,eAEpBC,EAAaC,mBACbC,EAAWC,cACXC,EAAUC,cAEhB,EAA4BC,qBAA5B,mBAAeC,GAAf,WACA,EAAgCD,qBAAhC,mBAAOE,EAAP,KAAiBC,EAAjB,KACA,EAA8BH,mBAAS,GAAvC,mBAAgBI,GAAhB,WAEMC,EAAeC,YAAYC,KAC3BC,EAAeF,YAAYG,KAG7BC,EAAM,GACNC,EAAO,GAGLC,EAAetC,UAAU,CAC3BuC,KAAK,utBAWLC,WAAW,CAAC,GAAI,MAGpBC,qBAAU,WACN,MAAuBrB,EAAhBsB,QAGHC,SAHJ,MAAiB,GAAjB,GACOC,gBAES,GAShB,OAP2B,IAAxBb,EAAac,QAAgBF,GAC5BG,cACCC,MAAK,SAAAxD,GACF+B,EAAS0B,YAAoBzD,EAAI0D,UAIlC,WAAQN,GAAY,KAE5B,CAACZ,IAqCJ,SAASmB,IACDlC,GACAmC,uBAAuBC,oBACtBL,MAAK,SAACM,GACc,YAAbA,GACJC,OAAOC,iBAAiB,oBAAqBC,GAAS,MAKzDC,OAAM,kBAAMrG,MAAM,oBAK3B,SAASoG,EAAQE,GACb,IAAIC,EAAUD,EAAEE,sBAAwBC,KAAKC,IAAIJ,EAAEK,MAAQ,KAC3DjC,EAAW6B,GACe,qBAAhBL,OAAOU,OACbV,OAAOU,KAAKvG,MAAMwG,UAAlB,iBAAwCN,EAAxC,SAKRlB,qBAAU,WAAO,IAAD,YAnDPzB,GACDsC,OAAOC,iBAAiB,4BAA6BC,GAAS,GAqDlE,MAAuBpC,EAAhBsB,QACgBpD,QADvB,MAAiB,GAAjB,GACOsD,eAEHK,EAAO,CACTiB,QAAO,OAAErD,QAAF,IAAEA,GAAF,UAAEA,EAAcsD,cAAhB,iBAAE,EAAsBvC,gBAAxB,aAAE,EAAgCQ,IACzCgC,SAAQ,OAAEvD,QAAF,IAAEA,GAAF,UAAEA,EAAcsD,cAAhB,iBAAE,EAAsBvC,gBAAxB,aAAE,EAAgCS,KAC1CgC,MAAK,OAAExD,QAAF,IAAEA,GAAF,UAAEA,EAAce,gBAAhB,aAAE,EAAwBQ,IAC/BkC,OAAM,OAAEzD,QAAF,IAAEA,GAAF,UAAEA,EAAce,gBAAhB,aAAE,EAAwBS,MAGlCrC,UAAUuE,QAAQ,CACdC,UAAW,CACTxE,SAASiD,EAAKiB,QAASjB,EAAKmB,UAC5BpE,SAASiD,EAAKoB,MAAOpB,EAAKqB,SAE5BG,kBAAkB,EAClBC,iBAAkB,CAACC,QAAQ,QAE3BC,gBAAgB,SAACC,GACb,IAAIC,EAAU,CACVC,SAAQ,OAAGF,QAAH,IAAGA,OAAH,EAAGA,EAAME,SACjBC,KAAI,OAAGH,QAAH,IAAGA,OAAH,EAAGA,EAAMG,MAGjBlE,EAAWgE,MAEhBG,MAAM3F,KAEX,CAACyB,IAGH0B,qBAAU,WACN,IAAMyC,EAAW1D,EAAQ2D,QAAO,WACE,qBAApB7B,OAAO8B,WACbnE,UAAUoE,YAAYC,WAAWhC,OAAO8B,iBACjC9B,OAAOiC,cACPjC,OAAOU,SAItB,OAAO,WAAQkB,OAChB,IAGH,IAAMM,EAAkB,WAEpBtC,IAEA,MAAyB9B,EAAjBsB,eAAR,MAAkB,GAAlB,EACwBpD,EAAQoD,EAAxBE,eAERhC,GAAc,IAAIZ,cAAeiF,MAAM3F,GAEvC,IAAImG,EAAU,CACVC,oBAAoB,GAGxBpC,OAAO8B,SAAWnE,UAAUoE,YAAYM,eAAc,SAACpG,GACvD6C,EAAM7C,EAAIqG,OAAOC,SACjBxD,EAAO9C,EAAIqG,OAAOE,UAClB,IAAIC,EAAUA,EAENzG,IACAA,EAAI0G,QAAQ,CAAC5D,EAAKC,IAClBzB,EAAYqF,cAER3C,OAAOiC,QAmBPjC,OAAOiC,OACNW,UAAU,CAAC9D,EAAKC,IAEjB8D,iBAAyB,CACrB/D,IAAKA,EACLgE,IAAK/D,EACLgE,gBAAgB,EAChB,kBAAmB,KACnBC,KAAM,KAETvD,MAAK,SAACwD,GACH1E,EAAYD,GACZ4E,SAASC,cAAc,iBAAiBhH,MAAQ8G,EAAOG,kBA9B3DpD,OAAOiC,OAASvF,SAAS,CAACoC,EAAKC,GAAO,CAClCsE,KAAMrE,EACNsE,WAAW,IACZ3B,MAAM3F,GAET6G,iBAAyB,CACrB/D,IAAKA,EACLgE,IAAK/D,EACLgE,gBAAgB,EAChB,kBAAmB,KACnBC,KAAM,KAETvD,MAAK,SAACwD,GACH1E,EAAYD,GACZ4E,SAASC,cAAc,iBAAiBhH,MAAQ8G,EAAOG,iBAoB3C,OAAjB7F,GACCgG,YAAmBzE,EAAKC,EAAM0D,EAAZ,OAAqBlF,QAArB,IAAqBA,OAArB,EAAqBA,EAAcnB,IACpDqD,MAAK,SAAAxD,GACFlB,QAAQC,IAAI,6BAIpBgF,OAAOU,KAAOwC,SAASC,cAAc,yBAE3CK,EAAOrB,IAIb,SAASqB,EAAMC,GACX1I,QAAQ2I,KAAK,SAAWD,EAAIE,KAAO,MAAQF,EAAIG,SAwDnDzE,qBAAU,WAEN,GAA2B,qBAAjBP,GAA0D,OAA1BA,EAAaN,UAA6C,IAAxBM,EAAaW,OAAc,CACnG,MAAuBzB,EAAhBsB,QACgBpD,QADvB,MAAiB,GAAjB,GACOsD,gBACa,IAAI5C,cAAeiF,MAAM3F,GAEjC2G,cAEZ3C,OAAOiC,OAASvF,SAAU,CAACkC,EAAaN,SAASQ,IAAKF,EAAaN,SAASS,MAAO,CAC/EuE,WAAW,IACZ3B,MAAM3F,GACJ6H,UAAU,2BACVC,YAEL9H,EAAI0G,QAAQ,CAAC9D,EAAaN,SAASQ,IAAKF,EAAaN,SAASS,OAC9DgF,OAGL,CAACnF,IAEJ,IAAMmF,EAAY,WACd/D,OAAOiC,OAAO+B,GAAG,WAAW,SAAS5D,GAAI,IAAD,IACpCyC,iBAAyB,CACrB/D,IAAG,OAAEsB,QAAF,IAAEA,GAAF,UAAEA,EAAG6D,cAAL,aAAE,EAAWC,QAAX,IACLpB,IAAG,OAAE1C,QAAF,IAAEA,GAAF,UAAEA,EAAG6D,cAAL,aAAE,EAAWC,QAAX,IACLnB,gBAAgB,EAChB,kBAAmB,KACnBC,KAAM,KAETvD,MAAK,SAACwD,GAAY,IAAD,EACdjD,OAAOiC,OAAOW,UAAd,OAAwBxC,QAAxB,IAAwBA,GAAxB,UAAwBA,EAAG6D,cAA3B,aAAwB,EAAWC,SACnC,IAAI5F,EAAW,CACX,KAAQ2E,EAAOkB,QAAQC,QAAUnB,EAAOkB,QAAQE,MAAQpB,EAAOkB,QAAQG,KACvE,MAAUrB,EAAOkB,QAAQI,QAAUtB,EAAOkB,QAAQK,OAClD,QAAWvB,EAAOkB,QAAQM,QAC1B,KAAQxB,EAAOH,IACf,IAAMG,EAAOnE,IACb,cAAiBmE,EAAOG,cAE5B/E,EAAU4E,EAAOG,cACjBF,SAASC,cAAc,iBAAiBhH,MAAQ8G,EAAOG,aACvD7E,EAAYD,UAcxB,OACE,qBAAKjE,UAAU,gBAAf,SACE,eAAC,IAAD,CACIqK,OApSO,CAAC,WAAY,WAqSpBC,QAAQ,IACRC,QAAQ,KACR5B,KAAK,KACL6B,UAAU,EACVC,iBAAiB,EACjBC,iBAAiB,EACjBzK,IAAKwD,EART,UAYI,cAACkH,EAAA,EAAD,CACIC,IAAI,mEACJC,YAAY,0FAdpB,OAmBQzG,QAnBR,IAmBQA,OAnBR,EAmBQA,EAAczC,KAAI,SAACC,EAAKC,GAAN,OACd,cAACiJ,EAAA,EAAD,CAAmBC,SAAU,CAACnJ,EAAIqC,SAAJ,IAAqBrC,EAAIqC,SAAJ,MAAuB+E,KAAMjG,EAAhF,SACI,eAACiI,EAAA,EAAD,CAASC,QAAM,EAACC,OAAQ,CAAC,GAAI,MAAOxJ,UAAW,MAAOyJ,QAAS,EAA/D,UACI,mBAAGnL,UAAW,mBAAd,4BACA,4BAAI4B,EAAIwJ,WAAY,IAAKxJ,EAAIyJ,gBAHxBxJ,MASrB,cAAC,IAAD,CACMJ,SA9HM,SAACyF,GACjB,MAAyBzD,EAAjBsB,QACgBpD,QADxB,MAAkB,GAAlB,GACQsD,eACFhC,GAAc,IAAIZ,cAAeiF,MAAM3F,GAE7CsB,EAAYqF,cAEc,qBAAhBpB,EAAKoE,QACX9C,iBAAyB,CACrB/D,IAAKyC,EAAKoE,OAAL,IACL7C,IAAKvB,EAAKoE,OAAL,IACL5C,gBAAgB,EAChB,kBAAmB,KACnBC,KAAM,KAETvD,MAAK,SAACwD,GAEH,GADA3F,EAAYqF,cACgB,qBAAlB3C,OAAOiC,OAAuB,CACpCjC,OAAOiC,OAAOW,UAAUrB,EAAKoE,QAE7B,IAAIrH,EAAW,CACX,KAAQ2E,EAAOkB,QAAQC,QAAUnB,EAAOkB,QAAQE,MAAQpB,EAAOkB,QAAQG,KACvE,MAAUrB,EAAOkB,QAAQI,QAAUtB,EAAOkB,QAAQK,OAClD,QAAWvB,EAAOkB,QAAQM,QAC1B,KAAQxB,EAAOH,IACf,IAAMG,EAAOnE,IACb,cAAiBmE,EAAOG,cAG5BF,SAASC,cAAc,iBAAiBhH,MAAQ8G,EAAOG,aACvD7E,EAAYD,GACZyF,SAgGFqB,SAAS,UACTQ,iBAAiB,sBACjBC,YAAY,EACZxC,MAAM,EACNL,KAAM,GACN8C,qBAAqB,EACrBC,kBAAkB,EAClBC,gBAAiB,CACfC,aAAc,CACV,CAAC,WAAY,WACb,CAAC,WAAY,aAEb1B,OAAQ,QAKpB,wBAAQlK,UAAU,gBAAgBM,QAhVzB,WACbuH,KA+UI,SACI,cAACgE,EAAA,EAAD,CAAa/L,MAAO,CAAEgM,SAAU,mB,4CCjEjCC,UA1VK,SAAC7M,GACGA,EAAhB8M,YADwB,IAAD,UAEvBrI,EAAWC,cAEjB,EAA4CG,oBAAS,GAArD,mBAAO5E,EAAP,KAAuB8M,EAAvB,KAEA,EAA0ClI,mBAAS,MAAnD,mBAAOmI,EAAP,KAAsBC,EAAtB,KACA,EAA8BpI,oBAAS,GAAvC,mBAAOvE,EAAP,KAAgB4M,EAAhB,KACA,EAA8BrI,mBAAS,MAAvC,mBAAOoD,EAAP,KAAgBhE,EAAhB,KACA,EAA8BY,mBAAS,GAAvC,mBAAOX,EAAP,KAAgBiJ,EAAhB,KACD,EAAsCtI,oBAAS,GAA/C,mBAAOuI,EAAP,KAAoBC,EAApB,KACC,EAAkDxI,oBAAS,GAA3D,mBAAOlD,EAAP,KAA0BC,EAA1B,KACA,EAAwCiD,mBAAS,MAAjD,oBAAO7C,GAAP,MAAqBsL,GAArB,MACA,GAA0BzI,mBAAS,GAAnC,qBAAO/C,GAAP,MAAcyL,GAAd,MAEIrN,GAAUsE,mBACRgJ,GAAehJ,mBACfiJ,GAAgBjJ,mBAEhBR,GAAemB,YAAYuI,KAE3BnN,GAAQoN,IAAMpN,MAEJqE,cAsBhB,SAASgJ,KACPC,YAAe,GACd3H,MAAK,SAAAxD,GACJ,GAA2B,GAAxBA,EAAI0D,KAAKA,KAAKJ,OAKf,OAJAvB,EAASqJ,YAAkB,OAC3Bb,EAAiB,MACjBE,EAAWjJ,EAAU,QACrBgJ,GAAW,GAIbzI,EAASqJ,YAAkBpL,EAAI0D,KAAKA,KAAK,GAAG2H,UAC5Cd,EAAiBvK,EAAI0D,KAAKA,KAAK,IAC/B+G,EAAWjJ,EAAU,GACrBgJ,GAAW,MACVtG,OAAM,SAAAsD,GACP8D,IAAMC,KAAK,0BApCfrI,qBAAU,WACR,IAAIE,GAAY,EAchB,OAZGA,IACmB,OAAjB9B,GACD4J,MAEAV,GAAW,GACXgB,YAAW,WACTf,EAAWjJ,EAAU,KACpB,OAKA,WAAQ4B,GAAY,KAG1B,CAAC9B,KAsBJ,IAKMmK,GAAqB,SAACtL,GAE1B,GAAS,GAANA,EAAQ,CACT,IAAIuL,EAAW,IAAIC,SAanB,OAZAD,EAASE,OAAO,eAAgB,GAChCF,EAASE,OAAO,aAActK,GAAanB,IAC3CuL,EAASE,OAAO,UAAW,cAE3BC,YAAkBvB,EAAcnK,GAAIuL,GACnClI,MAAK,SAAAxD,GACJsL,IAAMQ,QAAQ,qCACdZ,QACChH,OAAO,SAAAsD,GACR1I,QAAQC,IAAIyI,GACZ8D,IAAMQ,QAAQ,4BAKlB,GAAS,GAAN3L,EAAQ,CACT,IAAIuL,EAAW,IAAIC,SAanB,OAZAD,EAASE,OAAO,eAAgB,GAChCF,EAASE,OAAO,aAActK,GAAanB,IAC3CuL,EAASE,OAAO,UAAW,cAE3BC,YAAkBvB,EAAcnK,GAAIuL,GACnClI,MAAK,SAAAxD,GACJsL,IAAMQ,QAAQ,sCACdZ,QACChH,OAAO,SAAAsD,GACR1I,QAAQC,IAAIyI,GACZ8D,IAAMQ,QAAQ,4BAKT,GAAN3L,EAKH4L,YAAczK,GAAanB,IAC1BqD,MAAK,SAAAxD,GACJsL,IAAMQ,QAAQ,8CACd/J,EAASqJ,YAAkB,OAC3BF,QACChH,OAAM,SAAAsD,GACP8D,IAAMC,KAAK/D,EAAI1D,SAASJ,KAAKiE,YAV7B0C,GAAkB,IAgEtBnH,qBAAU,WAGR,IAAIE,GAAY,EAWhB,OAVF4I,cACGxI,MAAK,SAAAxD,GAEDoD,GACDwH,GAAgB5K,EAAI0D,SAErBQ,OAAM,SAAAsD,GACP3J,GAAM2J,EAAIG,YAGL,WAAQvE,GAAY,KAE3B,IAGH,IAwBO6I,GAAgB,kBAAM,gDAE5B,OAAGrO,EAAgB,GAGjB,eAAC,IAAD,WACA,0BAASQ,UAAU,mCAAnB,UAEE,sBAAKA,UAAU,+BAAf,UACE,qBAAKA,UAAU,4BAAf,SACE,cAAC,IAAD,CACEA,UAAU,SACV8N,IACE,cAAC,IAAD,CAAOA,IAAI,sDAAsDC,MAAM,WAK/E,cAACC,EAAD,CAAO9K,aAAcA,GAAcC,WAAYA,EAAYC,QAASA,OAKjD,OAAjBF,IAAwD,KAAnB,OAAZA,SAAY,IAAZA,QAAA,EAAAA,GAAc+K,cACvC,qCACE,wBAAQjO,UAAU,yBAAyBM,QA/GnD,WACEoM,GAAa3H,QAAQjF,MAAMoO,WAAa,UACxCxB,GAAa3H,QAAQjF,MAAMqO,OAAS,OACpCxB,GAAc5H,QAAQjF,MAAMoO,WAAa,UA4G6BjO,IAAK0M,GAArE,SAAoF,mBAAG3M,UAAU,qBACjG,qBAAKA,UAAU,sBAAsBC,IAAKyM,GAA1C,SACE,sBAAK1M,UAAU,YAAf,UACE,sBAAKA,UAAU,SAAf,UACE,cAAC,IAAD,CACEA,UAAU,iBACV8N,IACE,cAAC,IAAD,CAAOA,IAAI,0DAGf,sBAAK9N,UAAU,OAAf,UACE,mBAAGA,UAAU,oDAAb,SAAmEkD,GAAasD,OAAO4E,WAAa,IAAMlI,GAAasD,OAAO6E,YAC9H,mBAAGrL,UAAU,cAAb,gBAA6BkD,SAA7B,IAA6BA,IAA7B,UAA6BA,GAAcsD,cAA3C,iBAA6B,EAAsBvC,gBAAnD,aAA6B,EAAgCgG,UAE9B,QAAnB,OAAZ/G,SAAY,IAAZA,QAAA,EAAAA,GAAc+K,cACd,qBAAKjO,UAAU,+BAAf,SACE,mBAAGoO,KAAI,qBAASlL,SAAT,IAASA,IAAT,UAASA,GAAcsD,cAAvB,aAAS,EAAsB6H,OAAtC,SAA+C,wBAAQrO,UAAU,gCAAlB,SAC7C,cAACsO,EAAA,EAAD,UAGJ,wBAAQtO,UAAU,gEAAgEF,MAAO,CAACiO,MAAM,OAAQQ,OAAO,OAAQzC,SAAS,QAASvL,UAAQ,EAAjJ,SACA,cAAC,IAAD,CAAWiO,KAAMC,KAAKC,MAAQ,IAAWC,SAAU,SAAAzP,GAAK,OAAI,8BAAMA,EAAM0P,WAAxE,SACE,cAACf,GAAD,QAKJ,qBAAK7N,UAAW,kBAAmBM,QAhJjD,WACIoM,GAAa3H,QAAQjF,MAAMqO,OAAS,SACpCzB,GAAa3H,QAAQjF,MAAMoO,WAAa,SACxCvB,GAAc5H,QAAQjF,MAAMoO,WAAa,WA6I/B,SACE,mBAAGlO,UAAU,0BAGjB,qBAAKA,UAAU,cAAf,SACE,gCACE,mBAAGA,UAAU,iBAAb,4BACA,oBAAGA,UAAU,oBAAb,iBAAmCkD,SAAnC,IAAmCA,IAAnC,UAAmCA,GAAc2L,gBAAjD,aAAmC,EAAwB7M,MAA3D,KAAsEkB,GAAa4L,sBAIvF,qBAAK9O,UAAU,cAAf,SACE,sBAAKA,UAAU,SAAf,UACE,mBAAGA,UAAU,sDACb,mBAAGA,UAAU,cAAb,gBAA6BkD,SAA7B,IAA6BA,IAA7B,UAA6BA,GAAce,gBAA3C,aAA6B,EAAwB8K,qBAIzD,sBAAK/O,UAAU,SAAf,UACE,wBAAOA,UAAU,UAAjB,8BAAsCmH,QAAtC,IAAsCA,OAAtC,EAAsCA,EAASC,YAC/C,uBAAOpH,UAAU,eAAjB,eACA,wBAAOA,UAAU,UAAjB,0BAAkCmH,QAAlC,IAAkCA,OAAlC,EAAkCA,EAASE,WAG7C,sBAAKrH,UAAU,cAAf,UACI,cAAC,IAAD,CACEK,KAAK,UACLL,UAAU,QACVM,QAAS,WACP,OAAuC,KAAnB,OAAb4L,QAAa,IAAbA,OAAA,EAAAA,EAAe+B,cACpBxO,GAAM,SAAU,kBAAmB,CACjC,CAAEe,KAAM,SAAUC,QAAS,kBAAMC,QAAQC,IAAI,YAC7C,CAAEH,KAAM,KAAMC,QAAS,kBAAM4M,GAAkB,OAACnB,QAAD,IAACA,OAAD,EAACA,EAAe+B,kBAC9DZ,GAAkB,OAACnB,QAAD,IAACA,OAAD,EAACA,EAAe+B,eAR3C,SAWoC,KAAnB,OAAb/B,QAAa,IAAbA,OAAA,EAAAA,EAAe+B,cAAqB,oBAAsD,KAAnB,OAAb/B,QAAa,IAAbA,OAAA,EAAAA,EAAe+B,cAAqB,SAA2C,KAAnB,OAAb/B,QAAa,IAAbA,OAAA,EAAAA,EAAe+B,cAAqB,YAAc,WAG/J,cAAC,IAAD,CACAjO,UAAU,OACVM,QAAS,WAC2B,QAAnB,OAAb4L,QAAa,IAAbA,OAAA,EAAAA,EAAe+B,eAAgE,qBAAvC,OAAO/B,QAAP,IAAOA,OAAP,EAAOA,EAAe+B,cAC/DxO,GAAM,SAAU,kBAAmB,CAClC,CAAEe,KAAM,SAAUC,QAAS,kBAAMC,QAAQC,IAAI,YAC7C,CAAEH,KAAM,KAAMC,QAAS,kBAAMkD,EAASqJ,YAAkB,WACrDlM,GAAqB,IAP5B,iCAaR,MAKN,cAAC,IAAD,CACC3B,eAAgBA,EACfG,aApQiB,WACnB2M,GAAkB,GACpB7M,GAAQ2F,QAAQiK,SAmQZ5P,QAASA,GACTI,QAASA,EACTD,UAjMc,WAClBH,GAAQ2F,QAAQiK,SAiMZ3P,iBA9LoB,WAAO,IAAD,MAI9B,GAFA+M,GAAW,GAEsC,IAA7ChN,GAAQ2F,QAAQkK,mBAAmBlB,MAGtC,OAFAb,IAAMC,KAAK,4CACXf,GAAW,GAIZ,IAAI8C,EAAM9P,GAAQ2F,QAAQkK,mBACxBE,UAAU,aAER7B,EAAW,IAAIC,SACnBD,EAASE,OAAO,aAAhB,OAA8BtB,QAA9B,IAA8BA,GAA9B,UAA8BA,EAAee,eAA7C,aAA8B,EAAwBlL,IACtDuL,EAASE,OAAO,2BAA4B4B,YAAcF,EAAK,oBAAchD,QAAd,IAAcA,GAAd,UAAcA,EAAee,eAA7B,aAAc,EAAwBoC,iBACrG/B,EAASE,OAAO,0BAAhB,OAA2CtB,QAA3C,IAA2CA,GAA3C,UAA2CA,EAAee,eAA1D,aAA2C,EAAwBoC,eAEnEC,YAAqBhC,GACnBlI,MAAK,SAAAxD,GACLsL,IAAMQ,QAAQ,kCACdzB,GAAkB,GACda,KACJV,GAAW,MAETtG,OAAM,SAAAsD,GACR8D,IAAMC,KAAK,yCACXf,GAAW,SAsKT,cAAC,IAAD,CACFvL,kBAAmBA,EACnBC,qBAAsBA,EACtBC,aA5IkB,SAACgF,GACrBA,EAAEwJ,iBACF,IAAIjC,EAAW,IAAIC,SAASxH,EAAE6D,QAC9B0D,EAASE,OAAO,aAAhB,OAA8BtK,SAA9B,IAA8BA,QAA9B,EAA8BA,GAAcnB,IAC5CwK,GAAe,GACfiD,YAAiBlC,GACflI,MAAK,SAAAxD,GACLsL,IAAMQ,QAAQ9L,EAAI0D,KAAKiE,SACvBzI,GAAqB,GACjBgM,KACJP,GAAe,MACbzG,OAAM,SAAAsD,GAAQ,IAAD,EACfqG,OAAOC,QAAP,OAAetG,QAAf,IAAeA,GAAf,UAAeA,EAAK9D,YAApB,aAAe,EAAWqK,QAAQhO,KAAI,SAAAC,GACrCsL,IAAMhG,KAAKtF,EAAI,GAAG,OAEnB2K,GAAe,OA8HfvL,MAAOA,GACPC,YAnJiB,SAAC8E,GACpB0G,GAAS1G,EAAE6D,OAAO9H,QAmJhBZ,aAAcA,GACd1B,QAAS8M","file":"static/js/19.a7342663.chunk.js","sourcesContent":["import SignatureCanvas from 'react-signature-canvas'\nimport { Modal, Button} from \"antd\"\nimport { Modal as modelMobile } from \"antd-mobile\"\nimport {\n\tLoadingOutlined,\n} from '@ant-design/icons';\n\nconst ModelSign = (props) => { \n\n    let {isModalVisible, signpad, completeDelivery, handleCancel, clearSign, loading} = props\n\n    const alert = modelMobile.alert;\n\n    return (\n        <Modal\n            visible={isModalVisible}\n            footer={null}\n            onCancel={handleCancel}\n            style={{ top: 20 }}\n            >\n            <p className=\"text-center text-lg f-w-600\">Reciever Signature</p>\n\n                    <SignatureCanvas ref={signpad} penColor='black'\n                    canvasProps={{className: 'sigCanvas border rounded my-4'}} />\n                    <Button block type=\"\" onClick={clearSign} className=\"mb-2\">\n                Clear signature\n            </Button>\n            <Button disabled={loading} block type=\"primary\"    \n                    onClick={() =>\n                        alert('Complete Delivery', 'Are you sure???', [\n                            { text: 'Cancel', onPress: () => console.log('cancel') },\n                            { text: 'Ok', onPress: () => completeDelivery()},\n                        ])\n                    }\n                    className=\"mb-2\">\n\n                    {loading ? <LoadingOutlined /> : \"Complete Delivery\"}\n            </Button>\n        </Modal>\n        )\n}\n\nexport default ModelSign","\nimport { Modal, Radio, Input, Button, Space } from \"antd\"\nimport {\n\tLoadingOutlined,\n} from '@ant-design/icons';\n\nconst CancelReasonsModal = (props) => {\n    let { cancelReasonModal, setCancelReasonModal, cancelSubmit, radio, handleRadio,  cancelReason, loading} = props\n    const { TextArea } = Input\n\n    return (\n\t\t<Modal\n        visible={cancelReasonModal}\n        footer={null}\n        onCancel={() => setCancelReasonModal(false)}\n        style={{ top: 20 }}\n        >\n            <p className=\" text-lg f-w-600\">Select one of the reason below?</p>\n            <div className=\"py-4\">\n            <form onSubmit={cancelSubmit}>\n                <Radio.Group name=\"cancel_reasons_id\" defaultValue={radio} onChange={handleRadio}>\n                    <Space direction=\"vertical\">\n                        {\n                            cancelReason?.map((res, key) => (\n                                <Radio value={res.id}  key={key} >{res.title} </Radio>\n                            ))\n                        }\n                        <Radio value={5}>Other</Radio>\n                    </Space>\n                \n                </Radio.Group>\n                {\n                    radio === 5 ?\n                    <TextArea\n                    required={true}\n                    className=\"mt-2\"\n                    rows={3}\n                    name={\"custom_cancel_reason\"}\n                    placeholder=\"Enter Reason Here\"\n                    /> : null\n                }\n\n                <Button block type=\"primary\" className=\"mb-0 mt-3\" htmlType=\"submit\">\n                   {loading ? <LoadingOutlined /> : \"Submit\"}\n                </Button>\n            </form>\n                    \n            </div>\n        </Modal>\n    )\n}\n\nexport default CancelReasonsModal","import './Map.css'\nimport React, {useEffect, useRef, useState} from \"react\";\nimport * as L from \"leaflet\";\nimport { Point } from \"leaflet\";\nimport 'leaflet-routing-machine';\nimport * as Nominatim from \"nominatim-browser\";\nimport {Map, Marker, Popup, TileLayer, Tooltip} from \"react-leaflet\";\nimport Search from \"react-leaflet-search\"\nimport {Toast} from \"antd-mobile\";\nimport {useDispatch, useSelector} from \"react-redux\";\nimport {storeLocation} from \"@/api/vendor\";\nimport {getUser} from \"@/reducers/reducers\";\nimport { allVendorLocation, storeVendorLocation } from \"@/reducers/rider/reducers\"\nimport { storeRiderLocation, getAllVendorLocation, getDirection } from \"@/api/rider/index\";\nimport {useHistory} from \"react-router-dom\";\nimport { AimOutlined } from \"@ant-design/icons\";\n\ndelete L.Icon.Default.prototype._getIconUrl;\n\nL.Icon.Default.mergeOptions({\n    iconRetinaUrl: \"Map Marker_8.png\",\n    iconUrl: \"Map Marker_8.png\",\n    iconSize: new Point(35, 35),\n    shadowUrl : ''\n});\n\nconst iconRider = L.icon({\n    iconRetinaUrl: \"Truck_6 (1).png\",\n    iconUrl: \"Truck_6 (1).png\",\n    iconSize: new Point(35, 35),\n    shadowUrl : ''\n});\n\nconst iconVendor = L.icon({\n    iconRetinaUrl: \"Map Marker_6.png\",\n    iconUrl: \"Map Marker_6.png\",\n    iconSize: new Point(35, 35),\n    shadowUrl : ''\n});\n\n\nconst MapComp = (props) => {\n    let { packageAlert, setSummary, refetch } = props;\n    const isIOS =\n    navigator.userAgent.match(/(iPod|iPhone|iPad)/) &&\n    navigator.userAgent.match(/AppleWebKit/);\n\n    const leafletMap = useRef()\n    const dispatch = useDispatch()\n    const history = useHistory()\n\n    const [search, setSearch] = useState()\n    const [location, setLocation] = useState()\n    const [heading, setHeading] = useState(0)\n\n    const allLocations = useSelector(allVendorLocation)\n    const userSelector = useSelector(getUser)\n\n    let markerLayer\n    let lat = ''\n    let long = ''\n    let pointDegree;\n\n    const iconAccurate = L.divIcon({\n        html:`<div class=\"accurate\" ><svg width=\"90\" height=\"90\" viewBox=\"0 0 1357 1357\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n        <path d=\"M926.575 248.275C851.09 204.694 765.463 181.75 678.3 181.75C591.137 181.75 505.51 204.694 430.025 248.275L678.3 678.3L926.575 248.275Z\" fill=\"url(#paint0_linear)\"/>\n        <circle cx=\"677.5\" cy=\"678.5\" r=\"144\" fill=\"#DB2B39\" stroke=\"#fff\" stroke-width=\"45\"/>\n        <defs>\n        <linearGradient id=\"paint0_linear\" x1=\"634.773\" y1=\"178.393\" x2=\"645.717\" y2=\"605.77\" gradientUnits=\"userSpaceOnUse\">\n        <stop stop-color=\"#DB2B39\" stop-opacity=\"0\"/>\n        <stop offset=\"1\" stop-color=\"#DB2B39\"/>\n        </linearGradient>\n        </defs>\n        </svg></div>\n        `,\n        iconAnchor:[40, 40]\n    })    \n\n    useEffect(() => {\n        const {current = {}} = leafletMap;\n        const {leafletElement: map} = current;\n\n        let isMounted = true\n\n        if(allLocations.length === 0 && isMounted){\n            getAllVendorLocation()\n            .then(res => {\n                dispatch(storeVendorLocation(res.data))\n            })\n        }\n\n        return () => { isMounted = false } \n\n    }, [allLocations])\n\n    const center = [27.7081859, 85.322004]\n\n    //@ when click locate me button fire \n    const locateMe = () => {\n        watchMyLocateMe();\n    }\n\n    function init() {\n        if (!isIOS) {\n            window.addEventListener(\"deviceorientationabsolute\", handler, true);\n        }\n    }\n\n\n    function calcDegreeToPoint(latitude, longitude) {\n        // Qibla geolocation\n        const point = {\n        lat: 21.422487,\n        lng: 39.826206\n        };\n\n        const phiK = (point.lat * Math.PI) / 180.0;\n        const lambdaK = (point.lng * Math.PI) / 180.0;\n        const phi = (latitude * Math.PI) / 180.0;\n        const lambda = (longitude * Math.PI) / 180.0;\n        const psi =\n        (180.0 / Math.PI) *\n        Math.atan2(\n            Math.sin(lambdaK - lambda),\n            Math.cos(phi) * Math.tan(phiK) -\n            Math.sin(phi) * Math.cos(lambdaK - lambda)\n        );\n        return Math.round(psi);\n    }\n\n    function startCompass() {\n        if (isIOS) {\n            DeviceOrientationEvent.requestPermission()\n            .then((response) => {\n                if (response === \"granted\") {\n                window.addEventListener(\"deviceorientation\", handler, true);\n                } else {\n                // alert(\"has to be allowed!\");\n                }\n            })\n            .catch(() => alert(\"not supported\"));\n        }\n    }\n\n\n    function handler(e) {\n        let compass = e.webkitCompassHeading || Math.abs(e.alpha - 360);\n        setHeading(compass)\n        if(typeof window.path !== \"undefined\"){\n            window.path.style.transform = `rotate(${compass}deg)`\n        }\n    }\n\n    //@ if has dialog for package \n    useEffect(() => {\n        init();\n\n        const {current = {}} = leafletMap;\n        const {leafletElement: map} = current;\n\n        let data = {\n          fromLat: packageAlert?.vendor?.location?.lat,\n          fromLong: packageAlert?.vendor?.location?.long,\n          toLat: packageAlert?.location?.lat,\n          toLong: packageAlert?.location?.long\n        }\n\n        L.Routing.control({\n            waypoints: [\n              L.latLng(data.fromLat, data.fromLong),\n              L.latLng(data.toLat, data.toLong)\n            ],\n            useZoomParameter: true,\n            pointMarkerStyle: {display:'none'},\n            // draggableWaypoints: false,\n            summaryTemplate:(info) => {\n                let summary = {\n                    distance : info?.distance,\n                    time : info?.time\n                }\n\n                setSummary(summary)\n            }\n        }).addTo(map);\n\n    },[refetch])    \n\n    //@ unlisten geolocation on route change\n    useEffect(() => {\n        const deactive = history.listen(() => {\n            if(typeof window.geoWatch !== \"undefined\"){\n                navigator.geolocation.clearWatch(window.geoWatch)\n                delete window.marker;\n                delete window.path;\n            }\n        })\n        \n        return () => { deactive() }\n    }, [])\n\n    //@ locate me realtime location\n    const watchMyLocateMe = (withMarker = false) => {\n\n        startCompass()\n\n        const { current = {} } = leafletMap;\n        const { leafletElement: map } = current;\n        \n        markerLayer = new L.LayerGroup().addTo(map);\n\n        let options = {\n            enableHighAccuracy: false\n        }\n\n        window.geoWatch = navigator.geolocation.watchPosition((res) => {\n        lat = res.coords.latitude\n        long = res.coords.longitude\n        let heading = heading\n  \n            if (map) {\n                map.setView([lat, long])\n                markerLayer.clearLayers()\n\n                if(!window.marker){\n                    window.marker = L.marker([lat, long], {\n                        icon: iconAccurate,\n                        draggable: false\n                    }).addTo(map)\n\n                    Nominatim.reverseGeocode({\n                        lat: lat,\n                        lon: long,\n                        addressdetails: true,\n                        \"accept-language\": \"np\",\n                        zoom: 17\n                    })\n                    .then((result) => {\n                        setLocation(location)\n                        document.querySelector('.search-input').value = result.display_name\n                    })\n\n                }else{\n                    window.marker\n                    .setLatLng([lat, long])\n\n                    Nominatim.reverseGeocode({\n                        lat: lat,\n                        lon: long,\n                        addressdetails: true,\n                        \"accept-language\": \"np\",\n                        zoom: 17\n                    })\n                    .then((result) => {\n                        setLocation(location)\n                        document.querySelector('.search-input').value = result.display_name\n                    })\n                }\n\n                if(packageAlert !== null){\n                    storeRiderLocation(lat, long, heading, packageAlert?.id)\n                    .then(res => {\n                        console.log('success location saved')\n                    })\n                }\n\n                window.path = document.querySelector('.accurate svg path')\n            }\n        },error, options)\n\n    }\n\n    function error(err) {\n        console.warn('ERROR(' + err.code + '): ' + err.message);\n    }\n\n    const customPopup = (SearchInfo) => {\n        return (\n            <Popup>\n                <div>\n                    <p>{SearchInfo.info}</p>\n                    <p>\n                        {SearchInfo.raw &&\n                        SearchInfo.raw.place_id &&\n                        JSON.stringify(SearchInfo.raw.place_id)}\n                    </p>\n                </div>\n            </Popup>\n        );\n    }\n\n    const searchEvent = (info) => {\n        const { current = {} } = leafletMap;\n        const { leafletElement: map } = current;\n        const markerLayer = new L.LayerGroup().addTo(map);\n\n        markerLayer.clearLayers()\n\n        if(typeof info.latLng !== \"undefined\"){\n            Nominatim.reverseGeocode({\n                lat: info.latLng['lat'],\n                lon: info.latLng['lng'],\n                addressdetails: true,\n                \"accept-language\": \"np\",\n                zoom: 18\n            })\n            .then((result) => {\n                markerLayer.clearLayers();\n                if(typeof window.marker !== \"undefined\"){\n                    window.marker.setLatLng(info.latLng)\n\n                    let location = {\n                        'city': result.address.suburb || result.address.town || result.address.city,\n                        'state':  result.address.region || result.address.county,\n                        'country': result.address.country,\n                        'long': result.lon,\n                        'lat':result.lat,\n                        'whole_address': result.display_name\n                    }\n\n                    document.querySelector('.search-input').value = result.display_name\n                    setLocation(location)\n                    markerSet()\n                }\n            })\n        }\n\n    }\n\n    useEffect(() => {\n\n        if(typeof userSelector !== \"undefined\" && userSelector.location !== null && userSelector.length !== 0) {\n            const {current = {}} = leafletMap;\n            const {leafletElement: map} = current;\n            const markerLayer = new L.LayerGroup().addTo(map);\n\n            markerLayer.clearLayers();\n\n            window.marker = L.marker( [userSelector.location.lat, userSelector.location.long] ,{\n                draggable: true,\n            }).addTo(map)\n                .bindPopup('Drag to change location')\n                .openPopup()\n\n            map.setView([userSelector.location.lat, userSelector.location.long])\n            markerSet()\n        }\n\n    }, [userSelector])\n\n    const markerSet = () => {\n        window.marker.on('dragend', function(e) {\n            Nominatim.reverseGeocode({\n                lat: e?.target?._latlng['lat'],\n                lon: e?.target?._latlng['lng'],\n                addressdetails: true,\n                \"accept-language\": \"np\",\n                zoom: 18\n            })\n            .then((result) => {\n                window.marker.setLatLng(e?.target?._latlng)\n                let location = {\n                    'city': result.address.suburb || result.address.town || result.address.city,\n                    'state':  result.address.region || result.address.county,\n                    'country': result.address.country,\n                    'long': result.lon,\n                    'lat':result.lat,\n                    'whole_address': result.display_name\n                }\n                setSearch(result.display_name)\n                document.querySelector('.search-input').value = result.display_name\n                setLocation(location)\n            })\n        });\n    }\n\n    const saveLocation = () => {\n        storeLocation(location)\n            .then(res => {\n                navigator.geolocation.clearWatch(window.geoWatch);\n                Toast.success('Location updated !!!', 2);\n                history.push('/dashboard');\n            })\n    }\n\n    return (\n      <div className=\"map-container\">\n        <Map\n            center={center}\n            minZoom=\"6\"\n            maxZoom=\"18\"\n            zoom=\"15\"\n            keyboard={true}\n            doubleClickZoom={true}\n            scrollWheelZoom={true}\n            ref={leafletMap}\n\n        >\n            \n            <TileLayer \n                url=\"https://tiles.stadiamaps.com/tiles/osm_bright/{z}/{x}/{y}{r}.png\" \n                attribution=\"&copy; <a href=&quot;https://www.openstreetmap.org/copyright&quot;>OpenStreetMap</a> contributors\" \n            />\n\n            {/* all vendor locations  */}\n            {   \n                allLocations?.map((res, key) => (\n                    <Marker key={key}  position={[res.location['lat'], res.location['long']]} icon={iconRider} >\n                        <Tooltip sticky offset={[0, -15.2]} direction={\"top\"} opacity={1}>\n                            <p className={\"font-weight-bold\"}>Sathixa Vendor</p>\n                            <p>{res.first_name +' '+ res.last_name}</p>\n                        </Tooltip>\n                    </Marker>\n                ))\n            }\n\n            <Search\n                  onChange={searchEvent}\n                  position=\"topleft\"\n                  inputPlaceholder=\"My current location\"\n                  showMarker={false}\n                  icon={false}\n                  zoom={14}\n                  closeResultsOnClick={true}\n                  openSearchOnLoad={true}\n                  providerOptions={{\n                    searchBounds: [\n                        [26.3477581, 30.446945],\n                        [80.0586226, 88.2015257]\n                    ],\n                        region: \"np\"\n                  }}\n            />\n\n\n            <button className=\"btn locate-me\" onClick={locateMe}>\n                <AimOutlined style={{ fontSize: '19px' }}/>\n            </button>\n        </Map>\n      </div>\n    );\n}\n\nexport default MapComp;\n","import \"leaflet/dist/leaflet.css\";\nimport { useHistory } from \"react-router-dom\";\nimport { useEffect, useState, useRef } from \"react\";\nimport { Avatar,Button, Image, message } from \"antd\";\nimport Layout from \"antd/lib/layout/layout\";\nimport MyMap from \"@/components/maps/MyMap\";\nimport { Modal, Toast } from 'antd-mobile';\nimport { acceptPackage, onGoingPackage, updateRiderStatus, savePackageSignature, getCancelReason, saveCancelReason } from \"@/api/rider/index\"\nimport DialogSign from \"@/components/rider/DeliverSignModal\"\nimport { dataURLtoFile } from \"@/helper/helper\"\nimport { storePackageAlert, packageAlertData } from \"@/reducers/rider/reducers\"\nimport { useSelector, useDispatch } from \"react-redux\";\nimport { PhoneOutlined } from '@ant-design/icons';\nimport CancelReasonsModal from \"@/components/rider/CancelReasonModal\"\nimport Countdown from \"react-countdown\";\n\nfunction confirm(e) {\n  message.success(\"Click on Yes\");\n}\n\nfunction cancel(e) {\n  message.error(\"Click on No\");\n}\n\nconst RiderAccept = (props) => {\n  let { mainHistory } = props\n  const dispatch = useDispatch()\n\n  const [isModalVisible, setIsModalVisible] = useState(false);\n  // const [packageAlert, setPackageAlert] = useState(null);\n  const [statusPackage, setStatusPackage] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [summary, setSummary] = useState(null);\n  const [refetch, setRefetch] = useState(0);\n\tconst [loadingCanc, setLoadingCanc] = useState(false)\n  const [cancelReasonModal, setCancelReasonModal] = useState(false)\n  const [cancelReason, setCancelReason] = useState(null)\n  const [radio, setRadio] = useState(1);\n  \n  let signpad = useRef();\n  const dialogAccept = useRef();\n  const showButtonRef = useRef();\n\n  const packageAlert = useSelector(packageAlertData)\n  \n  const alert = Modal.alert;\n\n  const history = useHistory();\n\n  useEffect(() => {\n    let isMounted = true\n\n    if(isMounted){\n      if(packageAlert === null)\n        fetchRecentPackage()\n      else{\n        setLoading(false)\n        setTimeout(() => {\n          setRefetch(refetch + 1);\n        }, 200)\n    \n      }\n    }\n\n    return () => { isMounted = false }\n\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [packageAlert])\n\n  function fetchRecentPackage() {\n    onGoingPackage(1)\n    .then(res => {\n      if(res.data.data.length == 0){\n        dispatch(storePackageAlert(null))\n        setStatusPackage(null);\n        setRefetch(refetch + 1);\n        setLoading(false);\n        return\n      }\n\n      dispatch(storePackageAlert(res.data.data[0].package))\n      setStatusPackage(res.data.data[0]);\n      setRefetch(refetch + 1);\n      setLoading(false);\n    }).catch(err => {\n      Toast.fail('someting went wrong')\n    })\n  }\n\n  const handleCancel = () => {\n    setIsModalVisible(false);\n\t\tsignpad.current.clear()\n  };\n\n  const riderAcceptPackage = (id) => {\n \n    if(id == 0){\n      let formData = new FormData();\n      formData.append('process_step', 1);\n      formData.append('package_id', packageAlert.id);\n      formData.append('_method', 'PATCH');\n\n      updateRiderStatus(statusPackage.id, formData)\n      .then(res => {\n        Toast.success('Okay! going to pickup the package')\n        fetchRecentPackage()\n      }).catch( err => {\n        console.log(err)\n        Toast.success('Something went wrong!')\n      })\n      return \n    }\n\n    if(id == 1){\n      let formData = new FormData();\n      formData.append('process_step', 2);\n      formData.append('package_id', packageAlert.id);\n      formData.append('_method', 'PATCH');\n\n      updateRiderStatus(statusPackage.id, formData)\n      .then(res => {\n        Toast.success('Successfully picked up the package')\n        fetchRecentPackage()\n      }).catch( err => {\n        console.log(err)\n        Toast.success('Something went wrong!')\n      })\n      return \n    }\n\n    if(id == 2){\n      setIsModalVisible(true)\n      return \n    }\n\n    acceptPackage(packageAlert.id)\n    .then(res => {\n      Toast.success('hurray!!! Package is successfully accepted');\n      dispatch(storePackageAlert(null))\n      fetchRecentPackage();\n    }).catch(err => {\n      Toast.fail(err.response.data.message)\n    })\n  }\n\n  // updateRiderStatus\n  function handleDialog() {\n      dialogAccept.current.style.bottom = \"-250px\"\n      dialogAccept.current.style.visibility = \"hidden\"\n      showButtonRef.current.style.visibility = \"visible\"\n  }\n\n  function showDialog() {\n    dialogAccept.current.style.visibility = \"visible\"\n    dialogAccept.current.style.bottom = \"14px\"\n    showButtonRef.current.style.visibility = \"hidden\"\n    \n  }\n\n  const clearSign = () => {\n\t\tsignpad.current.clear()\n\t}\n\n\tconst completeDelivery = () => {\n\n\t\tsetLoading(true)\n\n\t\tif (signpad.current.getTrimmedCanvas().width === 1) {\n\t\t\tToast.fail('Please add signature to the canvas.')\n\t\t\tsetLoading(false)\n\t\t\treturn\n\t\t}\n\n\t\tlet img = signpad.current.getTrimmedCanvas()\n\t\t\t.toDataURL('image/png');\n\n\t\tlet formData = new FormData()\n\t\tformData.append('package_id', statusPackage?.package?.id);\n\t\tformData.append('receiver_signature_image', dataURLtoFile(img, 'signature' + statusPackage?.package?.receiver_name))\n\t\tformData.append('receiver_signature_name', statusPackage?.package?.receiver_name)\n\n\t\tsavePackageSignature(formData)\n\t\t\t.then(res => {\n\t\t\t\tToast.success('Package delivered successfully');\n\t\t\t\tsetIsModalVisible(false);\n        fetchRecentPackage();\n\t\t\t\tsetLoading(false);\n\n\t\t\t}).catch(err => {\n\t\t\t\tToast.fail('Someting went wrong. please try again');\n\t\t\t\tsetLoading(false)\n\t\t\t})\n\n\t}\n\n  useEffect(() => {\n\t\t// pull cancel reason \n\n    let isMounted = true\n\t\tgetCancelReason()\n    .then(res => {\n\n      if(isMounted)\n        setCancelReason(res.data)\n      \n    }).catch(err => {\n      alert(err.message)\n    })\n\n    return () => { isMounted = false }\n\n\t}, [])\n\n  \t// handle radio button change from modal \n\tconst handleRadio = (e) => {\n\t\tsetRadio(e.target.value)\n\t}\n\n\t// cancel reason submit \n\tconst cancelSubmit = (e) => {\n\t\te.preventDefault()\n\t\tlet formData = new FormData(e.target)\n\t\tformData.append('package_id', packageAlert?.id);\n\t\tsetLoadingCanc(true)\n\t\tsaveCancelReason(formData)\n\t\t\t.then(res => {\n\t\t\t\tToast.success(res.data.message);\n\t\t\t\tsetCancelReasonModal(false);\n        fetchRecentPackage();\n\t\t\t\tsetLoadingCanc(false);\n\t\t\t}).catch(err => {\n\t\t\t\tObject.entries(err?.data?.errors).map(res => {\n\t\t\t\t\tToast.info(res[1][0]);\n\t\t\t\t})\n\t\t\t\tsetLoadingCanc(false)\n\t\t\t})\n\t}\n\n  const Completionist = () => <span>Time out!!!</span>;\n\n  if(loading) return ''\n\n  return (\n    <Layout>\n    <section className=\"vhc-100 map-bg position-relative\">\n    \n      <div className=\"common-map position-relative\">\n        <div className=\"col-2 my-auto profile-pop\">\n          <Avatar\n            className=\"ava-bg\"\n            src={\n              <Image src=\"https://uifaces.co/our-content/donated/KtCFjlD4.jpg\" width=\"90\" />\n            }\n          />\n        </div>\n\n      <MyMap packageAlert={packageAlert} setSummary={setSummary} refetch={refetch}/>\n\n      </div>\n\n      {\n        packageAlert !== null && packageAlert?.process_step !== 3 ?\n        <>\n          <button className=\"show-detail-dialog btn\" onClick={showDialog} ref={showButtonRef}><i className=\"fa fa-angle-up\"></i></button>\n          <div className=\"col-12 rider-accept\" ref={dialogAccept}>\n            <div className=\"card p-3 \">\n              <div className=\"d-flex\">\n                <Avatar\n                  className=\"ava-bg my-auto\"\n                  src={\n                    <Image src=\"https://uifaces.co/our-content/donated/KtCFjlD4.jpg\" />\n                  }\n                />\n                <div className=\"ml-2\">\n                  <p className=\"heading-xl f-w-600 line-height-07 text-capitalize\">{ packageAlert.vendor.first_name + ' ' + packageAlert.vendor.last_name  }</p>\n                  <p className=\"faded-text \">{ packageAlert?.vendor?.location?.city }</p>\n                </div>\n                { packageAlert?.process_step !== null ?\n                  <div className=\"ml-auto pl-3 mr-2 text-right\">\n                    <a href={`tel:${packageAlert?.vendor?.phone}`}><button className=\"btn btn-sm bg-light text-dark\">\n                      <PhoneOutlined />\n                    </button></a>\n                  </div> : \n                  <button className=\"ml-auto mr-2 text-white btn btn-sm bg-secondary border-15 p-0\" style={{width:\"24px\", height:\"24px\", fontSize:\"12px\"}} disabled>\n                  <Countdown date={Date.now() + 3000 * 10} renderer={props => <div>{props.seconds}</div>}>\n                    <Completionist />\n                  </Countdown>\n                  </button>\n                }\n\n                <div className={'pl-2 text-right'} onClick={handleDialog}>\n                  <i className=\"fa fa-angle-down\"></i>\n                </div>\n              </div>\n              <div className=\"d-flex mt-2\">\n                <div>\n                  <p className=\"faded-text-sm \">Delivery Items</p>\n                  <p className=\"heading-l f-w-600\">{ packageAlert?.category?.title } x{ packageAlert.no_of_package }</p>\n                </div>\n              </div>\n\n              <div className=\"d-flex my-2\">\n                <div className=\"d-flex\">\n                  <i className=\"fas fa-map-marker-alt fa-xs my-auto mr-1 text-red\"></i>\n                  <p className=\"faded-text \">{ packageAlert?.location?.whole_address }</p>\n                </div>\n              </div>\n\n              <div className=\"d-flex\">\n                <small className=\"my-auto\">Distance: {summary?.distance}</small>\n                <small className=\"my-auto mx-1\">|</small>\n                <small className=\"my-auto\">Time: {summary?.time}</small>\n              </div>\n\n              <div className=\"d-flex my-2\">\n                  <Button\n                    type=\"primary\"\n                    className=\"w-100\"\n                    onClick={() =>{\n                      return statusPackage?.process_step !== 2 ?\n                        alert('Accept', 'Are you sure???', [\n                          { text: 'Cancel', onPress: () => console.log('cancel') },\n                          { text: 'Ok', onPress: () => riderAcceptPackage(statusPackage?.process_step)},\n                      ]) : riderAcceptPackage(statusPackage?.process_step)\n                    }}\n                  >\n                    { statusPackage?.process_step === 0 ? \"Going For Package\" : statusPackage?.process_step === 1 ? \"Pickup\" : statusPackage?.process_step === 2 ? \"Delivered\" : \"Accept\"}\n                  </Button>\n                \n                  <Button\n                  className=\"ml-2\"\n                  onClick={() =>\n                    { statusPackage?.process_step === null || typeof statusPackage?.process_step === \"undefined\" ?\n                     alert('Cancel', 'Are you sure???', [\n                      { text: 'Cancel', onPress: () => console.log('cancel') },\n                      { text: 'Ok', onPress: () => dispatch(storePackageAlert(null))},\n                    ]) : setCancelReasonModal(true) }}\n                  > Cancel </Button>\n              </div>\n            </div>\n          </div>\n        </>\n        : \"\"\n      }\n  \n    </section>\n\n    <DialogSign \n    \tisModalVisible={isModalVisible}\n      handleCancel={handleCancel}\n      signpad={signpad}\n      loading={loading}\n      clearSign={clearSign}\n      completeDelivery={completeDelivery}\n      />\n\n      <CancelReasonsModal\n\t\t\t\tcancelReasonModal={cancelReasonModal}\n\t\t\t\tsetCancelReasonModal={setCancelReasonModal}\n\t\t\t\tcancelSubmit={cancelSubmit}\n\t\t\t\tradio={radio}\n\t\t\t\thandleRadio={handleRadio}\n\t\t\t\tcancelReason={cancelReason}\n\t\t\t\tloading={loadingCanc}\n\t\t\t/>\n\n    </Layout>\n  );\n};\n\nexport default RiderAccept;\n"],"sourceRoot":""}